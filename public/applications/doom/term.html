<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Webtop Terminal</title>
    <style>
        :root {
            --col: #00ff00;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            background: transparent;
            font-family: monospace;
            color: var(--col);
            overflow: auto;
        }

        #terminal {
            padding: 12px 16px;
            background: transparent;
            font-size: 1em;
            line-height: 1.5;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        pre {
            margin: 4px 0;
            white-space: pre-wrap;
            word-break: break-word;
        }
    </style>
</head>

<body>
    <div id="terminal"></div>

    <script>
        const terminal = document.getElementById('terminal');

        window.addEventListener("message", (event) => {
            if (event.data?.type === "term" && typeof event.data.line === "string") {
                const lineEl = document.createElement("pre");
                lineEl.textContent = event.data.line;
                terminal.appendChild(lineEl);

                terminal.scrollTop = terminal.scrollHeight;
                lineEl.scrollIntoView({ behavior: "smooth", block: "end" });

                if (event.data.line == "PANIC!!") {
                window.parent.postMessage({ type: "toast", line: "DOOM has crashed", type: "alert" }, "*");
                }
            }
        });

        const thumbNormal = window.parent.getAccent("rgba(0,0,0,0.5)");
        const thumbHover = window.parent.getAccent("rgba(0,0,0,0.9)");

        const style = document.createElement("style");
        style.textContent = `
  ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
  }

  ::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.1);
  } 

  ::-webkit-scrollbar-thumb {
    background: ${thumbNormal};
    border-radius: 6px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: ${thumbHover};
  }

  ::-webkit-scrollbar-corner {
    background: transparent;
  }
`;
        document.head.appendChild(style);

    </script>
</body>

</html>